<?xml version='1.0' encoding='utf-8'?>
<configDoc date="2025-05-14 01:16:49" fileName="representative_creator.plan" runtimeVersion="15.2.0.240425-7925-ed10bffb" cfgFilePath="workspace://Training (2)/Training_commented/plans/representative_creator.plan" screen="images/screen_representative_creator.plan.png" companyImage="images/logo_about.png" version="1.0">
  <generatorMeta date="2025-05-14 01:16:57" about="{1}

Version: {4} 
Runtime: {5} 
Build: {6} 

Copyright Â© 2002-{3} {2}. All rights reserved.

Your use of the product is subject to the {0} end user license agreement." name="Ataccama ONE Desktop" company="Ataccama Corporation"/>
  <configAlg image="images/TextFileReader.large.png" name="personnel (Text File Reader)" class="com.ataccama.dqc.tasks.io.text.read.TextFileReader">
    <properties lineMaxReadLength="65536" fileName="../data/in/personnel.csv" fieldSeparator="," stringQualifierEscape="" numberOfLinesInFooter="0" compression="NONE" encoding="ISO-8859-1" lineSeparator="\r\n" stringQualifier="" numberOfLinesInHeader="1">
      <columns>
        <textReaderColumn name="ser_customer_id" ignore="false" type="INTEGER">
          <dataFormatParameters decimalSeparator="." thousandsSeparator=","/>
        </textReaderColumn>
        <textReaderColumn name="src_customer_name" ignore="false" type="STRING"/>
        <textReaderColumn name="src_collateral_value" ignore="false" type="STRING"/>
        <textReaderColumn name="src_secured_value" ignore="false" type="STRING"/>
        <textReaderColumn name="src_type" ignore="false" type="INTEGER">
          <dataFormatParameters decimalSeparator="." thousandsSeparator=","/>
        </textReaderColumn>
        <textReaderColumn name="src_source_country" ignore="false" type="STRING"/>
      </columns>
      <dataFormatParameters falseValue="false" dateTimeFormat="yy-MM-dd HH:mm:ss" decimalSeparator="." dayFormat="yy-MM-dd" trueValue="true" dateFormatLocale="en_US" thousandsSeparator=""/>
      <errorHandlingStrategy rejectFileName="rejected.txt">
        <errorInstructions>
          <errorInstruction dataStrategy="READ_POSSIBLE" errorType="EXTRA_DATA" putToLog="true" putToReject="false"/>
          <errorInstruction dataStrategy="STOP" errorType="LONG_LINE" putToLog="true" putToReject="true"/>
          <errorInstruction dataStrategy="STOP" errorType="PROCESSING_ERROR" putToLog="true" putToReject="false"/>
          <errorInstruction dataStrategy="READ_POSSIBLE" errorType="INVALID_DATE" putToLog="true" putToReject="false"/>
          <errorInstruction dataStrategy="READ_POSSIBLE" errorType="SHORT_LINE" putToLog="true" putToReject="true"/>
          <errorInstruction dataStrategy="NULL_VALUE" errorType="UNPARSABLE_FIELD" putToLog="true" putToReject="false"/>
        </errorInstructions>
      </errorHandlingStrategy>
      <shadowColumns/>
    </properties>
  </configAlg>
  <configAlg image="images/AlterFormat.large.png" name="Add columns (Alter Format)" class="com.ataccama.dqc.tasks.flow.AlterFormat">
    <properties>
      <addedColumns>
        <addedColumn name="size" type="INTEGER"/>
      </addedColumns>
      <removedColumns/>
    </properties>
  </configAlg>
  <configAlg image="images/RepresentativeCreator.large.png" name="Representative Creator (Representative Creator)" class="com.ataccama.dqc.tasks.identify.bob.RepresentativeCreator">
    <properties>
      <groupingStrategy class="com.ataccama.dqc.tasks.common.group.KeyGroupingStrategy">
        <groupBy>
          <keyComponent expression="ser_customer_id"/>
        </groupBy>
      </groupingStrategy>
      <rules>
        <rule when="src_type=600">
          <attributeSets>
            <attributeSetCfg>
              <instanceAttributes>
                <attributeCfgInst expression="sum(src_type)" name="size"/>
                <attributeCfgInst expression="iif(this.src_source_country is null,&#39;NULL&#39;,this.src_source_country)" name="src_source_country"/>
              </instanceAttributes>
              <representativeAttributes>
                <attributeCfgRepr expression="best.ser_customer_id" name="ser_customer_id"/>
                <attributeCfgRepr expression="best.src_type" name="src_type"/>
              </representativeAttributes>
              <selectionRules>
                <aggregatingOrderBy expression="src_type" nullsFirst="false" orderDescending="false"/>
              </selectionRules>
            </attributeSetCfg>
          </attributeSets>
        </rule>
      </rules>
    </properties>
  </configAlg>
  <configAlg image="images/TextFileWriter.large.png" name="Golden src_type and ser_cutomer_id clomns selected based on selection rules for groups which have at lease one src_type=600 (Text File Writer)" class="com.ataccama.dqc.tasks.io.text.write.TextFileWriter">
    <properties writeHeader="true" fileName="../data/out/representitive_out_merged.csv" fieldSeparator=";" generateMetadata="true" stringQualifierEscape="&quot;" writeAllColumns="true" compression="NONE" encoding="UTF-8" lineSeparator="\r\n" stringQualifier="&quot;" useStringQualifierOnAllColumns="false">
      <columns/>
      <dataFormatParameters falseValue="false" dateTimeFormat="yyyy-MM-dd HH:mm:ss" decimalSeparator="." dayFormat="yyyy-MM-dd" trueValue="true" dateFormatLocale="en_US" thousandsSeparator=""/>
    </properties>
  </configAlg>
  <configAlg image="images/TextFileWriter.large.png" name="Enriched data with aggregated results (Text File Writer)" class="com.ataccama.dqc.tasks.io.text.write.TextFileWriter">
    <properties writeHeader="true" fileName="../data/out/Representive_out.csv" fieldSeparator=";" generateMetadata="true" stringQualifierEscape="&quot;" writeAllColumns="true" compression="NONE" encoding="UTF-8" lineSeparator="\r\n" stringQualifier="&quot;" useStringQualifierOnAllColumns="false">
      <columns/>
      <dataFormatParameters falseValue="false" dateTimeFormat="yyyy-MM-dd HH:mm:ss" decimalSeparator="." dayFormat="yyyy-MM-dd" trueValue="true" dateFormatLocale="en_US" thousandsSeparator=""/>
    </properties>
  </configAlg>
</configDoc>